%YAML:1.0

#path of temperary recording files for analysis
test.InitVIOTmpPath: "/home/leavesnight/tmp/zzh/"

# Timestamp shift(s) Timage = Timu/Tenc + image_delay
Camera.delaytoimu: -0.0035
Camera.delaytoenc: 0.
# when IMU is read as Polling, Timu_cached = Timage_tracking_process + polling_delay (u can also use this to slow Tracking thread)
Camera.delayForPolling: 0.005

# 2 differential driving wheels' distance (m)
Encoder.rc: 0.280

# encoder coefficient to m/s : vscaleforhall=2.0/ppr*M_PI*wheelradius/datatime=2.0/400*M_PI*0.105/10
Encoder.scale: 1.649336143e-4

# encoder_sigma[8]: el,er,em[6](vx,vy,vz,wx,wy,wz) [m/s/sqrt(Hz),model: m/s^2/sqrt(Hz)]
Encoder.sigma:
 [1.58e-2, 1.58e-2, 3.16e-2, 3.16e-2, 3.16e-2, 3.16e-2, 3.16e-2, 3.16e-2]

# mode 0 is normal right order gxgygz/axayaz, 1 means -gy,gxgz/-ay,axaz
IMU.mode: 0

# Sigma etawi of IMU
IMU.SigmaI:
 [0.1, 0, 0,
  0, 0.1, 0,
  0, 0, 1]

# sigma[4]: g(gyroscope_noise_density) a(accelerometer_noise_density) bg(gyroscope_random_walk) ba(accelerometer_random_walk); notice Sigma_g/ad=sigma_g(/_a)^2/dt, Sigma_bg(/_ba)=sigma_bg(/_ba)^2, Cov_bgd(/_bad)=Sigma_bg(/_ba)*deltat
IMU.sigma:
# [4.887e-5, 6.867e-4, 1.e-6, 1.e-5]
# [ 4.887e-5, 6.8e-2, 1.e-5, 1.e-2]
# [4.887e-5, 6.8e-3, 1.e-5, 1.e-3]
 [7.8e-5, 6.5e-3, 4.0e-5, 7.3e-3]
# [7.8e-4, 6.5e-3, 4.0e-5, 7.3e-4]

IMU.freq_hz: 1000.0
IMU.dt_cov_noise_fix: 1

# acc=acc*IMU.dMultiplyG, if below is 9.80665 meaning acc=acc*9.80665, but internal referenced G used for prior is still 9.810
IMU.dMultiplyG: 1.

# camera-imu frame transformation, Pi = Tic * Pc; For stereo: it's the rectified left(0) camera's Tbc'=Tbc0*Tc'c0.inv(), notice LEFT.R is Rc'c0(R1) & tc'c0=0
Camera.Tbc:
 [0.205751503,  0.961302852,  0.183202475,  0.098727246,
  -0.734924525,  0.275401410, -0.619709615,  0.001714600,
  -0.646182839, -0.007133807,  0.763149295, -0.008435362,
  0        ,   0,           0         ,  1]

# imu-encoder frame transformation
Camera.Tce:
 [0.000000000, -1.000000000,  0.000000000,  -0.015000000,
  0.000000000,  0.000000000, -1.000000000,  0.473000000,
  1.000000000,  0.000000000,  0.000000000, -0.518000000,
  0.000000000,  0.000000000,  0.000000000,  1.000000000]

# Local Window size(0 means pure-vision+IMU Initialzation but no IMU error in BA): JW is 20, VIORBSLAM paper uses 10, but 5 for V203 in my PC
LocalMapping.LocalWindowSize: 10

# the Error allow between "simultaneous" IMU data(Timu=Timu+delaytoimu) & Image's mTimeStamp(Timg): Timu=[Timg-err,Timg+err]; out of this range, no IMU data is used between 2KFs/Fs, max 1/fps; we suppose ErrEncImg=ErrIMUImg
ErrIMUImg: 0.03

# IMU Initialization Check starts at InitTime and ends at FinalTime, the IMU Initialization thread also sleep(SleepTime) (s)
IMU.InitTime: 0
IMU.FinalTime: 3
IMU.SleepTime: 1.0

# normal & initial & final Full BA iterations, default is 10,15,20; final uses 0 means no Full BA at the end of execution
GBA.iterations: 10
GBA.initIterations: 15
GBA.finalIterations: 0
GBA.threshMatches : 10
GBA.threshInliers : 10

#--------------------------------------------------------------------------------------------
# Camera Parameters. Adjust them!
#--------------------------------------------------------------------------------------------

Camera.type: "KannalaBrandt8"
# Camera calibration and distortion parameters (OpenCV)
Camera.fx: 236.2553424
Camera.fy: 236.4032548
Camera.cx: 324.8966443
Camera.cy: 234.4389331
Camera.k1: 0.2199028132
Camera.k2: -0.1837567343
Camera.k3: 0.07210837555
Camera.k4: -0.01235045548
Camera2.fx: 235.3122598
Camera2.fy: 235.3212268
Camera2.cx: 326.5729568
Camera2.cy: 237.2301666
Camera2.k1: 0.2087072841
Camera2.k2: -0.1541047646
Camera2.k3: 0.05286879394
Camera2.k4: -0.008114462618
Camera3.fx: 236.166088
Camera3.fy: 236.7958767
Camera3.cx: 323.0022689
Camera3.cy: 234.4116281
Camera3.k1: 0.2148564737
Camera3.k2: -0.1658555278
Camera3.k3: 0.05985639284
Camera3.k4: -0.0094873298
Camera4.fx: 235.1491539
Camera4.fy: 235.2319349
Camera4.cx: 325.3250572
Camera4.cy: 239.9981874
Camera4.k1: 0.220454711
Camera4.k2: -0.1799165826
Camera4.k3: 0.06929442276
Camera4.k4: -0.01154349279
# Transformation matrix from reference camera to current camera
Camera2.Trc: !!opencv-matrix
  rows: 3
  cols: 4
  dt: f
  data: [ -0.738196001, -0.093657106, -0.668053150, -0.044936471,
          -0.630813330, -0.255083970,  0.732807418,  0.040851564,
          -0.239042272,  0.962372337,  0.129221815, -0.028719701]
Camera3.Trc: !!opencv-matrix
  rows: 3
  cols: 4
  dt: f
  data: [ -0.432481888,  0.045666185, -0.900485434, -0.073482611,
           0.900575390,  0.070456448, -0.428952044, -0.119458943,
           0.043856402, -0.996469010, -0.071596980, -0.054941829]
Camera4.Trc: !!opencv-matrix
  rows: 3
  cols: 4
  dt: f
  data: [ 0.923738356,  0.376164108, -0.072166564, -0.022963171,
         -0.376872043,  0.858989645, -0.346560604, -0.106545338,
         -0.068373330,  0.347328883,  0.935247419, -0.017116447]

# Lapping area between images
Camera.lappingBegin: 0
Camera.lappingEnd: 639
Camera2.lappingBegin: 0
Camera2.lappingEnd: 639
Camera3.lappingBegin: 0
Camera3.lappingEnd: 639
Camera4.lappingBegin: 0
Camera4.lappingEnd: 639
Camera.width: 640
Camera.height: 480

# Camera frames per second 
Camera.fps: 30.0

# Color order of the images (0: BGR, 1: RGB. It is ignored if images are grayscale)
Camera.RGB: 1

# stereo baseline times fx
Camera.bf: 15.7801
# Close/Far threshold. Baseline times.
ThDepth: 35.0 # 35

#--------------------------------------------------------------------------------------------
# ORB Parameters
#--------------------------------------------------------------------------------------------

# ORB Extractor: Number of features per image
ORBextractor.nFeatures: 350

# ORB Extractor: Scale factor between levels in the scale pyramid 	
ORBextractor.scaleFactor: 2.

# ORB Extractor: Number of levels in the scale pyramid	
ORBextractor.nLevels: 4

# ORB Extractor: Fast threshold
# Image is divided in a grid. At each cell FAST are extracted imposing a minimum response.
# Firstly we impose iniThFAST. If no corners are detected we impose a lower value minThFAST
# You can lower these values if your images have low contrast			
ORBextractor.iniThFAST: 20
ORBextractor.minThFAST: 7

#--------------------------------------------------------------------------------------------
# Viewer Parameters
#---------------------------------------------------------------------------------------------
Viewer.KeyFrameSize: 0.05
Viewer.KeyFrameLineWidth: 1
Viewer.GraphLineWidth: 0.9
Viewer.PointSize: 2
Viewer.CameraSize: 0.08
Viewer.CameraLineWidth: 3
Viewer.ViewpointX: 0
Viewer.ViewpointY: -0.7
Viewer.ViewpointZ: -1.8
Viewer.ViewpointF: 500

